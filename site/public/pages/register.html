<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Day By Day - Register</title>
		<link rel="stylesheet" href="register.css" />
	</head>
	<body>
		<div class="alerta" id="notification">
			<div class="icon">
				<div class="circle">
					!
				</div>
			</div>
			<div class="text">
				<p  id="content"></p>
			</div>
		</div>
		<div class="main">
			<div class="mainMenu" id="menu">
				<div class="container borderBot">
					<div class="link">
						<a href="../index.html">Inicio</a>
					</div>
					<div class="link">
						<a href="./perfil.html">Perfil</a>
					</div>
					<div class="link">
						<a href="./cursos.html">Cursos</a>
					</div>
					<div class="link">
						<a href="./future.html">Futuro</a>
					</div>
				</div>
			</div>
			<div class="nav borderBot">
				<div class="logo">
					<a href="../index.html">Day by Day</a>
				</div>
				<div class="menu" onclick="toggle()">
					<div class="icon"></div>
					<p>menu</p>
				</div>
				<div class="register">
					<ul>
						<li class="borderRight"><a href="./login.html">login</a></li>
						<li><a href="./register.css">register</a></li>
					</ul>
				</div>
			</div>

			<div class="register">
				<div class="container">
					<div class="box borderRight">
						<div class="row borderBot">
							<div class="label"><p>Nome:</p></div>
							<input type="text" id="ipt_nome" class="inputText" />
						</div>

						<div class="row borderBot">
							<div class="label"><p>Email:</p></div>
							<input type="text" id="ipt_email" class="inputText" />
						</div>

						<div class="row borderBot">
							<div class="label"><p>Senha:</p></div>
							<input type="password" id="ipt_senha" class="inputText" />
						</div>

						<div class="row borderBot">
							<div class="label"><p>Confirmar senha:</p></div>
							<input type="password" id="ipt_cnfSenha" class="inputText" />
						</div>

						<div class="row">
							<div class="label"><p>Estado de residencia:</p></div>
							<select id="ipt_estado">
								<option value="">Selecione</option>
								<option value="AC">Acre</option>
								<option value="AL">Alagoas</option>
								<option value="AP">Amapá</option>
								<option value="AM">Amazonas</option>
								<option value="BA">Bahia</option>
								<option value="CE">Ceará</option>
								<option value="DF">Distrito Federal</option>
								<option value="ES">Espirito Santo</option>
								<option value="GO">Goiás</option>
								<option value="MA">Maranhão</option>
								<option value="MS">Mato Grosso do Sul</option>
								<option value="MT">Mato Grosso</option>
								<option value="MG">Minas Gerais</option>
								<option value="PA">Pará</option>
								<option value="PB">Paraíba</option>
								<option value="PR">Paraná</option>
								<option value="PE">Pernambuco</option>
								<option value="PI">Piauí</option>
								<option value="RJ">Rio de Janeiro</option>
								<option value="RN">Rio Grande do Norte</option>
								<option value="RS">Rio Grande do Sul</option>
								<option value="RO">Rondônia</option>
								<option value="RR">Roraima</option>
								<option value="SC">Santa Catarina</option>
								<option value="SP">São Paulo</option>
								<option value="SE">Sergipe</option>
								<option value="TO">Tocantins</option>
							</select>
						</div>
					</div>

					<div class="submitBox borderTop">
						<button onclick="cadastrar()">cadastrar-se</button>
						<a href="./login.html">Já pussuo uma conta</a>
					</div>
				</div>
			</div>

			<div class="footer">
				<div class="container borderTop">
					<div class="box borderRight">
						<div class="text">
							<p>Ficou com alguma duvida?</p>
							<p>Algum ponto a adicionar?</p>
							<p>Algum agradecimento?</p>
							<p>ou apenas um olá?</p>
							<p style="margin-top: 10px">
								Envie sua mensagem e podemos conversar!
							</p>
						</div>
						<div class="square1"></div>
						<div class="ball1"></div>
					</div>

					<div class="send">
						<form action="">
							<div class="field">
								<label for="">Nome:</label>
								<input type="text" id="ipt_ident" />
							</div>

							<div class="field">
								<label for="">Mensagem:</label>
								<textarea name="comment" id="ipt_msg"></textarea>
							</div>

							<div class="field">
								<div class="btn">Enviar</div>
							</div>
						</form>
					</div>
				</div>
				<div class="navigation borderTop">
					<div class="box borderRight">
						<a href="../index.html">
							<p>inicio</p>
						</a>
					</div>
					<div class="box borderRight">
						<a href="./cursos.html">
							<p>cursos</p>
						</a>
					</div>
					<div class="box borderRight">
						<a href="./perfil.html">
							<p>perfil</p>
						</a>
					</div>
					<div class="box">
						<a href="./future.html">
							<p>futuro</p>
						</a>
					</div>
				</div>
				<div class="copyRight borderTop">
					<p>©2023. Erick Nunes</p>
				</div>
			</div>
		</div>
	</body>
</html>

<script src="../js/funcoes.js"></script>

<script>

	function cadastrar() {
		//Recupere o valor da nova input pelo nome do id
		// Agora vá para o método fetch logo abaixo
		var nomeVar = ipt_nome.value;
		var emailVar = ipt_email.value;
		var estadoVar = ipt_estado.value;
		var senhaVar = ipt_senha.value;
		var confirmacaoSenhaVar = ipt_cnfSenha.value;

		if (
			nomeVar == "" ||
			emailVar == "" ||
			senhaVar == "" ||
			confirmacaoSenhaVar == ""
		) {
			notify('Falha ao registrar, certifique-se de preencher os campos devidamente.')
			return false;
		}

		// Enviando o valor da nova input
		fetch("/usuarios/cadastrar", {
			method: "POST",
			headers: {
				"Content-Type": "application/json",
			},
			body: JSON.stringify({
				// crie um atributo que recebe o valor recuperado aqui
				// Agora vá para o arquivo routes/usuario.js
				nomeServer: nomeVar,
				estadoServer: estadoVar,
				emailServer: emailVar,
				senhaServer: senhaVar,
			}),
		})
			.then(function (resposta) {
				console.log("resposta: ", resposta);

				if (resposta.ok) {
					notify('Cadastrado com sucesso!')
					setTimeout(() => {
						window.location = "/pages/login.html";
					}, "2000");
				} else {
					throw "Houve um erro ao tentar realizar o cadastro!";
				}
			})
			.catch(function (resposta) {
				console.log(`#ERRO: ${resposta}`);
			});

		return false;
	}
</script>
